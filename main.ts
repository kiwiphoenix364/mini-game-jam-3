function setUpTrack2 () {
    pxPrev = px = 20
pyPrev = py = 35
heading = 0
}
function drawSprites () {
    // renderer.place3dImage(ballImage, 10, 73, 0, 1)
    // renderer.place3dImage(ballImage, 11, 72, 0, 1)
    for (let i = 0; i <= treeX.length; i++) {
    	
    }
}
// console.log("Number of trees=" + treeX.length)
function initializeTrack () {
    treeX = []
    treeY = []
    for (let x = 0; x <= trackImage.width - 1; x++) {
        for (let y = 0; y <= trackImage.height - 1; y++) {
            if (trackImage.getPixel(x, y) == 1) {
                treeX.push(x)
                treeY.push(y)
            }
        }
    }
}
function configure () {
    renderer.setBackgroundImage(assets.image`background`)
renderer.setZClipFar(zFar)
controller.player1.analog = true
}
controller.menu.onEvent(ControllerButtonEvent.Pressed, function () {
    stats.turnStats(true)
})
let carVy = 0
let carVx = 0
let fwdY = 0
let fwdX = 0
let carPower = 0
let treeY: number[] = []
let treeX: number[] = []
let heading = 0
let trackImage: Image = null
game.splash("Please Wait...", "A Few Seconds")
let carAngularVelocity = 0
let throttle = 0
let py = 0
let px = 0
let mySprite = sprites.create(img`
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    `, SpriteKind.Player)
mySprite.setFlag(SpriteFlag.RelativeToCamera, true)
mySprite.z = 500
let treeImage = assets.image`tree`
let ballImage = assets.image`ball`
tiles.setCurrentTilemap(tilemap`level1`)
trackImage = image.create(4080, 4080)
redrawImg.GenerateImage()
tileUtil.unloadTilemap()
configure()
let carSprite = sprites.create(assets.image`car`, SpriteKind.Player)
carSprite.z = 200
let pxPrev = px
let pyPrev = py
// How far behind the player should the camera be placed?
let followDistance = 40
// Horizontal field of view in degrees. See backgroundImage comments,
// it should be matched to the background image width.
let fov = 90
// Y position of the horizon. Must match the backgroundImage (half) height.
let horizonY = 30
// Z near and far (horizon) view distances
let zNear = 30
let zFar = 300
// Color used for drawing ground outside the track texture.
let outsideTrackColor = 8
renderer.setUp(drawSprites)
renderer.placePlayerSprite(carSprite, 12, 17)
let carDragForward = 0.03
let carDragSideways = 0.15
let carDragSidewaysDrift = 0.04
let carDragOffroad = 0.2
let carAngularDrag = 0.85
let carAngularDragDrift = 0.95
setUpTrack2()
initializeTrack()
enum TerrainType {
    ROAD,
    OFFROAD,
    OBSTACLE,
    FINISH_LINE
}
let hOffset = -18
let hJumpSpeed = -20
let hAccel = 0.2
let arrayx = [
-4,
4,
-4,
-4,
4,
4,
-4,
4,
4,
3,
-4,
-3,
4,
3,
-4,
-3,
-3,
-3,
3,
3,
3,
-3,
3,
-3,
-2,
-3,
-3,
-1,
-1,
-2,
2,
3,
3,
1,
1,
2
]
let arrayy = [
4,
4,
4,
4,
4,
4,
4,
4,
4,
-4,
4,
-4,
4,
-4,
4,
-4,
-4,
-4,
-4,
-4,
-4,
-4,
-4,
-4,
4,
4,
4,
4,
4,
4,
4,
4,
4,
4,
4,
4
]
let arrayh = [
0,
0,
0,
4,
0,
4,
4,
4,
0,
0,
0,
0,
4,
3,
4,
3,
0,
3,
0,
3,
0,
0,
3,
3,
3,
2,
2,
2,
2,
3,
3,
2,
2,
2,
2,
3
]
game.onUpdate(function () {
    mySprite.setImage(img`
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        `)
    for (let index7 = 0; index7 <= 2; index7++) {
        if (index7 < 12) {
            renderer.place3dLine(1, px + arrayx[index7 * 2] * Math.cos((heading + 0) * Math.PI / 180), py + arrayy[index7 * 2] * (0 - Math.sin((heading + 0) * Math.PI / 180)), arrayh[index7 * 2], px + arrayx[index7 * 2 + 1] * Math.cos((heading + 0) * Math.PI / 180), py + arrayy[index7 * 2 + 1] * (0 - Math.sin((heading + 0) * Math.PI / 180)), arrayh[index7 * 2 + 1])
        } else {
            renderer.place3dLine(9, px + arrayx[index7 * 2] * Math.cos((heading + 0) * Math.PI / 180), py + arrayy[index7 * 2] * (0 - Math.sin((heading + 0) * Math.PI / 180)), arrayh[index7 * 2], px + arrayx[index7 * 2 + 1] * Math.cos((heading + 0) * Math.PI / 180), py + arrayy[index7 * 2 + 1] * (0 - Math.sin((heading + 0) * Math.PI / 180)), arrayh[index7 * 2 + 1])
        }
    }
})
game.onUpdate(function () {
    heading += controller.player2.dx()
    carPower = controller.dy(-25)
    if (heading < 0) {
        heading += 360
    }
    if (heading >= 360) {
        heading += 0 - 360
    }
    fwdX = Math.sin(heading * Math.PI / 180)
    fwdY = 0 - Math.cos(heading * Math.PI / 180)
    carVx += carPower * fwdX
    carVy += carPower * fwdY
    carVx += controller.dx(-25) * Math.sin((heading + 270) * Math.PI / 180)
    carVy += controller.dx(-25) * (0 - Math.cos((heading + 270) * Math.PI / 180))
    px += carVx
    py += carVy
    carVx += 0 - carVx / 10
    carVy += 0 - carVy / 10
    if (px < 0) {
        px = 0
    }
    if (py < 0) {
        py = 0
    }
})
